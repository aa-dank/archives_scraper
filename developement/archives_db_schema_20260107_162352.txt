ARCHIVES DATABASE SCHEMA DOCUMENTATION
==================================================

Generated on: 2026-01-07T16:23:51.499471
Database: business_services_db

TABLES:
--------------------

Table: archived_files (BASE TABLE)
Primary Keys: id
Columns:
   1. id (PK): integer NOT NULL DEFAULT nextval('archived_files_id_seq'::regclass)
   2. destination_path: character varying NOT NULL
   3. project_number: character varying NULL
   4. document_date: character varying NULL
   5. destination_directory: character varying NULL
   6. file_code: character varying NULL
   7. file_size: double precision NOT NULL
   8. date_archived: timestamp without time zone NOT NULL
   9. archivist_id: integer NOT NULL
  10. notes: character varying NULL
  11. filename: character varying NULL
  12. file_id: integer NULL

Table: caans (BASE TABLE)
Primary Keys: id
Columns:
   1. id (PK): integer NOT NULL DEFAULT nextval('caans_id_seq'::regclass)
   2. caan: character varying NOT NULL
   3. name: character varying NULL
   4. description: character varying NULL

Table: file_contents (BASE TABLE)
Primary Keys: file_hash
Columns:
   1. file_hash (PK): character varying NOT NULL
   2. source_text: text NULL
   3. minilm_model: text NULL DEFAULT 'all-minilm-l6-v2'::text
   4. minilm_emb: USER-DEFINED NULL
   5. mpnet_model: text NULL
   6. mpnet_emb: USER-DEFINED NULL
   7. updated_at: timestamp with time zone NULL DEFAULT now()
   8. text_length: integer NULL

Table: file_locations (BASE TABLE)
Primary Keys: id
Columns:
   1. id (PK): integer NOT NULL DEFAULT nextval('file_locations_id_seq'::regclass)
   2. file_id: integer NOT NULL
   3. file_server_directories: character varying NULL
   4. filename: character varying NULL
   5. existence_confirmed: timestamp without time zone NULL
   6. hash_confirmed: timestamp without time zone NULL

Table: files (BASE TABLE)
Primary Keys: id
Columns:
   1. id (PK): integer NOT NULL DEFAULT nextval('files_id_seq'::regclass)
   2. hash: character varying NOT NULL
   3. size: bigint NOT NULL
   4. extension: character varying NULL

Table: project_caans (BASE TABLE)
Primary Keys: project_id, caan_id
Columns:
   1. project_id (PK): integer NOT NULL
   2. caan_id (PK): integer NOT NULL

Table: projects (BASE TABLE)
Primary Keys: id
Columns:
   1. id (PK): integer NOT NULL DEFAULT nextval('projects_id_seq'::regclass)
   2. number: character varying NOT NULL
   3. name: character varying NOT NULL
   4. file_server_location: character varying NULL
   5. drawings: boolean NULL

Table: schema_migration (BASE TABLE)
Primary Keys: onerow_id
Columns:
   1. onerow_id (PK): boolean NOT NULL DEFAULT true
   2. background: integer NOT NULL
   3. data_loaded: boolean NOT NULL
   4. foreground: integer NOT NULL

Table: server_changes (BASE TABLE)
Primary Keys: id
Columns:
   1. id (PK): integer NOT NULL DEFAULT nextval('server_changes_id_seq'::regclass)
   2. old_path: character varying NULL
   3. new_path: character varying NULL
   4. change_type: character varying NOT NULL
   5. files_effected: integer NULL
   6. data_effected: numeric NULL
   7. date: timestamp without time zone NOT NULL
   8. user_id: integer NOT NULL

Table: timekeeper (BASE TABLE)
Primary Keys: id
Columns:
   1. id (PK): integer NOT NULL DEFAULT nextval('timekeeper_id_seq'::regclass)
   2. user_id: integer NOT NULL
   3. datetime: timestamp without time zone NOT NULL
   4. clock_in_event: boolean NOT NULL
   5. journal: text NULL

Table: users (BASE TABLE)
Primary Keys: id
Columns:
   1. id (PK): integer NOT NULL DEFAULT nextval('users_id_seq'::regclass)
   2. email: character varying NOT NULL
   3. first_name: character varying NULL
   4. last_name: character varying NULL
   5. roles: character varying NULL
   6. password: character varying(60) NULL
   7. active: boolean NOT NULL

Table: worker_tasks (BASE TABLE)
Primary Keys: id
Columns:
   1. id (PK): integer NOT NULL DEFAULT nextval('worker_tasks_id_seq'::regclass)
   2. task_id: character varying(255) NOT NULL
   3. time_enqueued: timestamp without time zone NOT NULL
   4. time_completed: timestamp without time zone NULL
   5. origin: character varying(255) NOT NULL
   6. function_name: character varying(255) NULL
   7. status: character varying(255) NULL
   8. task_results: json NULL


FOREIGN KEY RELATIONSHIPS:
------------------------------
project_caans.caan_id -> caans.id
project_caans.project_id -> projects.id


INDEXES:
--------------------

Table: archived_files
  archived_files_pkey: CREATE UNIQUE INDEX archived_files_pkey ON public.archived_files USING btree (id)

Table: caans
  caans_pkey: CREATE UNIQUE INDEX caans_pkey ON public.caans USING btree (id)

Table: file_contents
  file_contents_pkey: CREATE UNIQUE INDEX file_contents_pkey ON public.file_contents USING btree (file_hash)
  ix_file_contents_minilm_emb: CREATE INDEX ix_file_contents_minilm_emb ON public.file_contents USING ivfflat (minilm_emb vector_cosine_ops) WITH (lists='100')
  ix_file_contents_mpnet_emb: CREATE INDEX ix_file_contents_mpnet_emb ON public.file_contents USING ivfflat (mpnet_emb vector_cosine_ops) WITH (lists='100')

Table: file_locations
  file_locations_pkey: CREATE UNIQUE INDEX file_locations_pkey ON public.file_locations USING btree (id)
  idx_file_locations_filename_tsvector: CREATE INDEX idx_file_locations_filename_tsvector ON public.file_locations USING gin (to_tsvector('english'::regconfig, (filename)::text))
  idx_file_server_directories_gin: CREATE INDEX idx_file_server_directories_gin ON public.file_locations USING gin (to_tsvector('english'::regconfig, (file_server_directories)::text))

Table: files
  files_pkey: CREATE UNIQUE INDEX files_pkey ON public.files USING btree (id)
  ix_files_hash: CREATE UNIQUE INDEX ix_files_hash ON public.files USING btree (hash)

Table: project_caans
  project_caans_pkey: CREATE UNIQUE INDEX project_caans_pkey ON public.project_caans USING btree (project_id, caan_id)

Table: projects
  projects_pkey: CREATE UNIQUE INDEX projects_pkey ON public.projects USING btree (id)

Table: schema_migration
  schema_migration_pkey: CREATE UNIQUE INDEX schema_migration_pkey ON public.schema_migration USING btree (onerow_id)

Table: server_changes
  server_changes_pkey: CREATE UNIQUE INDEX server_changes_pkey ON public.server_changes USING btree (id)

Table: timekeeper
  timekeeper_pkey: CREATE UNIQUE INDEX timekeeper_pkey ON public.timekeeper USING btree (id)

Table: users
  users_email_key: CREATE UNIQUE INDEX users_email_key ON public.users USING btree (email)
  users_pkey: CREATE UNIQUE INDEX users_pkey ON public.users USING btree (id)

Table: worker_tasks
  worker_tasks_pkey: CREATE UNIQUE INDEX worker_tasks_pkey ON public.worker_tasks USING btree (id)
